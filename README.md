# Welcome to Peppermint

This repository is full stack expense tracking application, built with Ruby on Rails and React / Redux (styling coming soon).  Can be viewed [here](https://gigster-peppermint.herokuapp.com).


## User authentication
In hoping to keep the api as stateless as possible, user authentication was handled through the use of json web tokens that expire after one month. Tokens are saved as cookies in the user's browser, allowing for persistance of login information even when exiting the application, and passed along with each request.

The ApplicationController implemented the bulk of the authentication in the method below. Other controllers would call this method and pass all controller specific authentication log within the proc provided to keep code clean and DRY.
```
def authenticate(&prc)
  # If no proc given, no special authentication scheme required
  prc ||= Proc.new { true }
  token = get_token
  user_id = AuthHelper.get_valid_id(token)

  # If no valid token or prc (custom authentication) returns false
  if !user_id || !prc.call(user_id)
    render json: {error: "unauthorized"}, status: 401
  end
end
```

## Features
- There must be two types of users: regular users and admins
- A regular user:
  - Can log in and log out
  - Can generate reports of their spending over time (described in more detail in a later requirement)
  - Can create, read, update, and delete (CRUD) expenses they own
- Can not CRUD expenses they do not own
- An admin:
  - Must also satisfy requirements 3(a) through 3(c)
  - Can read all the saved expenses, including those which they do not own
  - Can not create, update, or delete expenses they do not own
- An expense:
  - Is owned by exactly one user
  - Contains at least the following fields:
  - Datetime, the date and time the transaction was made
  - Amount, the amount of money (in USD, precision of 0.01) associated with the expense
  - Description, a string describing the details of th transaction
  - Can only be created by a logged in user
  - Can only be read by either the user who owns it or an admin
  - Can only be updated and deleted by the user who owns it
- A report:
  - Shows the total amount spent per week by the logged in user
  - Can be filtered to only show expenses occuring within a user-provided datetime range
  - Can only be generated by users who are logged in
  - Must not contain expenses not owned by the user (even if the user is an admin)

## Testing
There were 41 total rspec tests covering API endpoints, testing for both user authentication / permissions and jbuilder template rendering.  Tests can be viewed in the /spec folder and can be ran with
``` bundle exec rspec. ```
